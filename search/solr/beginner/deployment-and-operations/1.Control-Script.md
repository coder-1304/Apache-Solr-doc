Solr includes a script called `bin/solr` that facilitates common operations on your Solr installation or cluster. This script allows you to start and stop Solr, manage collections or cores, interact with ZooKeeper, and check the status of Solr and configured shards.

You can locate the `bin/solr` script in the `bin/` directory of your Solr installation. It simplifies Solr management by offering straightforward commands and options to efficiently achieve various tasks.

# Starting and Stopping
## Start and Restart
The `start` command initiates Solr, while the `restart` command restarts Solr if it's already running or has been stopped.

Both commands offer options to run in SolrCloud mode, utilize an example configuration set, specify a non-default hostname or port, and connect to a local ZooKeeper ensemble.

- Start Solr: `bin/solr start [options]`
- Start command help: `bin/solr start -help`
- Restart Solr: `bin/solr restart [options]`
- Restart command help: `bin/solr restart -help`

When using the `restart` command, ensure to include all parameters initially used to start Solr. Internally, a stop request is triggered to stop Solr before restarting. If no nodes are running, the restart command skips the stop step and proceeds directly to starting Solr.

## Solr Command Line Options

### -a "options"

Start Solr with additional JVM parameters. These parameters can include options that start with `-X`, which are typically used to configure the Java Virtual Machine (JVM). 

If you need to pass JVM parameters that begin with "-D" (for example, `-Dsolr.port=8983`), you can omit the `-a` option.

Example:
```bash
bin/solr start -a "-Xdebug -Xrunjdwp:transport=dt_socket, server=y,suspend=n,address=1044"
```
In this example, Solr is started with additional JVM parameters `-Xdebug -Xrunjdwp:transport=dt_socket, server=y,suspend=n,address=1044`, which are used for remote debugging. This allows you to connect a debugger to Solr to diagnose issues or inspect the runtime behavior.

### -cloud

- Start Solr in SolrCloud mode, which will also launch the embedded ZooKeeper instance included with Solr.

- This option can be shortened to simply -c.

- If you are already running a ZooKeeper ensemble that you want to use instead of the embedded (single-node) ZooKeeper, you should also either specify ZK_HOST in solr.in.sh/solr.in.cmd or pass the -z parameter.

- Example: `bin/solr start -c`

### -d <dir>

- Define a server directory, defaults to server (as in, $SOLR_HOME/server). It is uncommon to override this option. When running multiple instances of Solr on the same host, it is more common to use the same server directory for each instance and use a unique Solr home directory using the -s option.

- Example: `bin/solr start -d newServerDir`

### -e <name>

Start Solr with an example configuration. These examples are provided to help you get started faster with Solr generally, or just try a specific feature.

The available options are:

- `cloud`: Start Solr in SolrCloud mode with an example configuration.
- `techproducts`: Start Solr with an example configuration for the TechProducts demo.
- `dih`: Start Solr with an example configuration for the DataImportHandler (DIH).
- `schemaless`: Start Solr with an example configuration for Schemaless mode.

Example: `bin/solr start -e schemaless`

### -f

Start Solr in the foreground. This means that Solr will run in the current terminal session, and you will see its output directly. Note that you cannot use this option when running examples with the `-e` option.

Example: `bin/solr start -f`

### -h <hostname>

Specify the hostname on which Solr should listen. If you don't specify a hostname, Solr will default to 'localhost', meaning it will only be accessible from the local machine.

Example: `bin/solr start -h search.mysolr.com`

In this command, Solr will start with the hostname search.mysolr.com. This means Solr will bind to the network interface associated with that hostname, allowing it to be accessed using that hostname from other machines on the network.

### -m <memory>

Set the minimum and maximum heap size for the Java Virtual Machine (JVM) that runs Solr. This option allows you to allocate a specific amount of memory to Solr, which can be useful for optimizing performance.

Example: `bin/solr start -m 1g`

### -noprompt

Start Solr without prompting for any additional configuration. This option is useful if you want to start Solr with all default settings.

Example: `bin/solr start -e cloud -noprompt`

### -p <port>

Specify the port on which Solr should listen for incoming connections. If you don't specify a port, Solr will default to port '8983'.

Example: `bin/solr start -p 8655`

### -s <dir>

Set the directory where Solr will create core directories. This option allows you to run multiple Solr instances on the same host while reusing the same server directory.

Example: `bin/solr start -s newHome`

### -v

Enable verbose mode, which increases the logging level of Solr. This changes the logging level of log4j from INFO to DEBUG. It can be useful for debugging purposes.

Example: `bin/solr start -f -v`

### -q

Enable quiet mode, which reduces the logging level of Solr. This can be useful in production settings where you want to limit logging to warnings and errors.

Example: `bin/solr start -f -q`

### -V

Start Solr with verbose messages from the start script. This can provide additional information about the startup process.

Example: `bin/solr start -V`

### -z <zkHost>

Specify the ZooKeeper connection string for SolrCloud mode. This option is used to connect Solr to an external ZooKeeper ensemble.

Example: `bin/solr start -c -z server1:2181,server2:2181`

### -force

Forcefully start Solr even if running as the root user. Normally, starting Solr as root is not recommended due to potential security risks.

Example: `sudo bin/solr start -force`

> It is not necessary to define all of the options when starting if the defaults are fine for your needs.


## Running with Example Configurations

The `bin/solr start -e <name>` command allows you to quickly get started with Solr using example configurations tailored to different use cases. These examples help you set up Solr for your specific needs without needing to manually configure everything from scratch.

### Example Configurations

- **cloud:** Starts a 1-4 node SolrCloud cluster on a single machine. An interactive session guides you through selecting the initial configset, number of nodes, ports, and collection name. Configsets can be chosen from `$SOLR_HOME/server/solr/configsets`.

- **techproducts:** Starts Solr in standalone mode with a schema designed for the sample documents in `$SOLR_HOME/example/exampledocs`.

- **dih:** Starts Solr in standalone mode with the DataImportHandler (DIH) enabled. Includes pre-configured `dataconfig.xml` files for different types of data sources supported by DIH. Configurations can be found in `$SOLR_HOME/example/example-DIH/solr/conf`.

- **schemaless:** Starts Solr in standalone mode with a managed schema, allowing dynamic field creation based on incoming documents. Configuration can be found in `$SOLR_HOME/server/solr/configsets/_default`.

Unless specified, these examples do not enable SolrCloud or schemaless mode. If you prefer manual editing of the `schema.xml` file, you can change this default setting as described in the "Schema Factory Definition in SolrConfig" section.


## Stop Command

The `stop` command is used to gracefully shut down a running Solr node. It sends a STOP request to the Solr node, allowing it to shut down properly. If the node does not shut down within 180 seconds, the command will forcefully kill the process. Here are the key options for the `stop` command:

- `-p <port>`: Stops the Solr instance running on the specified port.
  Example: `bin/solr stop -p 8983`

- `-all`: Stops all running Solr instances with a valid PID.
  Example: `bin/solr stop -all`

- `-k <key>`: Specifies a stop key to protect against inadvertently stopping Solr. The default key is "solrrocks".
  Example: `bin/solr stop -k solrrocks`

# System Information

## Version Command

The `version` command simply returns the version of Solr currently installed.
Example: `$ bin/solr version` - This will output the version number, such as "X.Y.0".

## Status Command

The `status` command displays basic information about any Solr nodes found running on the local system in JSON format. It uses the `SOLR_PID_DIR` environment variable to locate Solr process ID files, which defaults to the bin directory.
Example: `bin/solr status` - This will display the status of the running Solr nodes.

The output will include a status of each node of the cluster, for example:
```json
Found 2 Solr nodes:

Solr process 39920 running on port 7574
{
  "solr_home":"/Applications/Solr/example/cloud/node2/solr/",
  "version":"X.Y.0",
  "startTime":"2015-02-10T17:19:54.739Z",
  "uptime":"1 days, 23 hours, 55 minutes, 48 seconds",
  "memory":"77.2 MB (%15.7) of 490.7 MB",
  "cloud":{
    "ZooKeeper":"localhost:9865",
    "liveNodes":"2",
    "collections":"2"}}

Solr process 39827 running on port 8865
{
  "solr_home":"/Applications/Solr/example/cloud/node1/solr/",
  "version":"X.Y.0",
  "startTime":"2015-02-10T17:19:49.057Z",
  "uptime":"1 days, 23 hours, 55 minutes, 54 seconds",
  "memory":"94.2 MB (%19.2) of 490.7 MB",
  "cloud":{
    "ZooKeeper":"localhost:9865",
    "liveNodes":"2",
    "collections":"2"}}
```

## Healthcheck Command

The `healthcheck` command in SolrCloud mode generates a health report for a collection in JSON format. This report contains information about each replica's state for all shards in the collection, including the number of committed documents and its current status.

```bash
bin/solr healthcheck [options]
```

- `-c <collection>`: Specifies the name of the collection to run the health check against. This parameter is required.
Example:
```bash
bin/solr healthcheck -c gettingstarted
```

- `-z <zkhost>`: Specifies the ZooKeeper connection string. It defaults to localhost:9983 but should be specified if Solr is running on a port other than 8983. If ZK_HOST is defined in solr.in.sh or solr.in.cmd, this option is unnecessary.
Example:
```bash
bin/solr healthcheck -z localhost:2181
```

```json
{
  "collection":"gettingstarted",
  "status":"healthy",
  "numDocs":0,
  "numShards":2,
  "shards":[
    {
      "shard":"shard1",
      "status":"healthy",
      "replicas":[
        {
          "name":"core_node1",
          "url":"http://10.0.1.10:8865/solr/gettingstarted_shard1_replica2/",
          "numDocs":0,
          "status":"active",
          "uptime":"2 days, 1 hours, 18 minutes, 48 seconds",
          "memory":"25.6 MB (%5.2) of 490.7 MB",
          "leader":true},
        {
          "name":"core_node4",
          "url":"http://10.0.1.10:7574/solr/gettingstarted_shard1_replica1/",
          "numDocs":0,
          "status":"active",
          "uptime":"2 days, 1 hours, 18 minutes, 42 seconds",
          "memory":"95.3 MB (%19.4) of 490.7 MB"}]},
    {
      "shard":"shard2",
      "status":"healthy",
      "replicas":[
        {
          "name":"core_node2",
          "url":"http://10.0.1.10:8865/solr/gettingstarted_shard2_replica2/",
          "numDocs":0,
          "status":"active",
          "uptime":"2 days, 1 hours, 18 minutes, 48 seconds",
          "memory":"25.8 MB (%5.3) of 490.7 MB"},
        {
          "name":"core_node3",
          "url":"http://10.0.1.10:7574/solr/gettingstarted_shard2_replica1/",
          "numDocs":0,
          "status":"active",
          "uptime":"2 days, 1 hours, 18 minutes, 42 seconds",
          "memory":"95.4 MB (%19.4) of 490.7 MB",
          "leader":true}]}]}
```
